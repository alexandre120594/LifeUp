import type { Metadata } from "next";
import { Geist, Geist_Mono, Plus_Jakarta_Sans } from "next/font/google";
import "./globals.css";
import { SidebarProvider, SidebarTrigger } from "@/components/ui/sidebar";
import { AppSidebar } from "@/components/app-sidebar";
import Providers from "@/components/providers";
import { ThemeSwitcher } from "./ThemeSwitcher";

const themes = {
  emerald: { hue: "160", chroma: "0.12" },
  ocean: { hue: "230", chroma: "0.10" },
  gold: { hue: "85", chroma: "0.11" },
  rose: { hue: "0", chroma: "0.10" },
  grayscale: { hue: "0", chroma: "0" },
};

const jakartaSans = Plus_Jakarta_Sans({
  variable: "--font-plus_jakarta_-sans",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Yevox",
  description: "Generated by Yevox",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  const themeScript = `
  (function() {
    const themes = {
      evergreen: { p: { h: "168.48", c: "0.157" }, s: { h: "172.44", c: "0.035" } },
      spruce:    { p: { h: "180.73", c: "0.139" }, s: { h: "181.45", c: "0.033" } },
      seafoam:   { p: { h: "138.00", c: "0.111" }, s: { h: "138.74", c: "0.010" } },
      turquoise: { p: { h: "184.05", c: "0.136" }, s: { h: "187.91", c: "0.031" } },
      skyblue:   { p: { h: "232.06", c: "0.125" }, s: { h: "226.81", c: "0.027" } }
    };

    const saved = localStorage.getItem('app-theme-choice') || 'seafoam';
    const theme = themes[saved] || themes.seafoam;
    
    const root = document.documentElement;
    root.style.setProperty('--p-hue', theme.p.h);
    root.style.setProperty('--p-chroma', theme.p.c);
    root.style.setProperty('--s-hue', theme.s.h);
    root.style.setProperty('--s-chroma', theme.s.c);
  })()
`;
  return (
    <html lang="pt-BR" suppressHydrationWarning>
      <head>
        <script dangerouslySetInnerHTML={{ __html: themeScript }} />
      </head>
      <body className={`${jakartaSans.variable} antialiased font-sans`}>
        <Providers>
          <SidebarProvider>
            <AppSidebar />
            <main className="w-full min-h-screen flex flex-col bg-background">
              <header className="flex items-center justify-between p-4 border-b bg-yevox-white">
                <div className="flex items-center gap-2">
                  <SidebarTrigger />
                  <h1 className="text-sm font-semibold hidden sm:block">
                    Dashboard
                  </h1>
                </div>
              <ThemeSwitcher />
              </header>

              {/* Conteúdo da Página */}
              <div className="flex-1 p-4 md:p-8 md:max-w-dvw max-w-7xl mx-auto w-full">
                {children}
              </div>
            </main>
          </SidebarProvider>
        </Providers>
      </body>
    </html>
  );
}
